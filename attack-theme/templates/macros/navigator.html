{% macro layer_links(attack_id, page_type, layers) -%}
    {% if layers | length > 0 %}
        <div class="dropdown h3 mt-3 float-right">
            <button class="btn btn-navy dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <b>ATT&amp;CKâ„¢ Navigator Layers</b>
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                {% for layer in layers %}
                    {% if loop.index != 1 %} 
                    <div class="dropdown-divider"></div>
                    {% endif %}
                    <h6 class="dropdown-header">{{layer.domain | capitalize}} Layer</h6>
                    <a class="dropdown-item" href="{{ SITEURL }}/{{page_type}}/{{attack_id}}/{{layer.filename}}" download target="_blank">download</a>
                    <a class="dropdown-item" href="#" id="view-layer-on-navigator-{{layer.domain}}" target="_blank">view <img width="10" src="{{ SITEURL }}/theme/images/external-site-dark.jpeg"></a>
                    <script>
                        if (window.location.protocol == "https:") { //view on navigator only works when this site is hosted on HTTPS
                            layerURL = window.location.protocol + "//" + window.location.host + "/{{page_type}}/{{attack_id}}/{{layer.filename}}";
                            document.getElementById("view-layer-on-navigator-{{layer.domain}}").href = "https://mitre-attack.github.io/attack-navigator/{{layer.domain}}/#layerURL=" + encodeURIComponent(layerURL);
                        } else { //hide button
                            document.getElementById("view-layer-on-navigator-{{layer.domain}}").classList.add("d-none");
                        }
                    </script>
                {% endfor %}
            </div>
        </div>
    {% endif %}
{% endmacro %}